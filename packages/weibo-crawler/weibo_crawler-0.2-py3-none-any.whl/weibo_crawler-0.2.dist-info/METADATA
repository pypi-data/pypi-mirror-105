Metadata-Version: 2.1
Name: weibo-crawler
Version: 0.2
Summary: weibo_crawler æœ€ç®€å•çš„wieboçˆ¬è™«ï¼Œå¯ä»¥è½»åº¦çš„è¿›è¡Œå¾®åšæ•°æ®é‡‡é›†
Home-page: https://github.com/thunderhit/weibo_crawler
Author: å¤§é‚“
Author-email: thunderhit@qq.com
License: MIT
Keywords: data collect,æ•°æ®é‡‡é›†,weibo,å¾®åš
Platform: UNKNOWN
Requires-Python: >=3.5
Description-Content-Type: text/markdown
Requires-Dist: requests
Requires-Dist: pyquery

# ä¸€ã€ç®€ä»‹

weibo_crawlerå‚è€ƒ[ã€nghuyong/WeiboSpiderã€‘](https://github.com/nghuyong/WeiboSpider) å¯¹ä»£ç ç”¨æ³•è¿›è¡Œäº†ç®€åŒ–ï¼Œå¯ä»¥åšè½»åº¦çš„å¾®åšæ•°æ®é‡‡é›†ã€‚



### 1. 1 æ”¯æŒçˆ¬è™«

- ç”¨æˆ·ä¿¡æ¯æŠ“å–
- ç”¨æˆ·å¾®åšæŠ“å–(å…¨é‡/æŒ‡å®šæ—¶é—´æ®µ)
- ç”¨æˆ·ç¤¾äº¤å…³ç³»æŠ“å–(ç²‰ä¸/å…³æ³¨)
- å¾®åšè¯„è®ºæŠ“å–
- åŸºäºå…³é”®è¯å’Œæ—¶é—´æ®µ(ç²’åº¦åˆ°å°æ—¶)çš„å¾®åšæŠ“å–
- å¾®åšè½¬å‘æŠ“å–



<br>



# äºŒã€å®‰è£…

```
pip3 install weibo_crawler
```

<br>

# ä¸‰ã€å¿«é€Ÿä¸Šæ‰‹

weibo_crawleråº“çš„ä½¿ç”¨æ–¹æ³•

```
from weibo_crawler import Profile, Follow, Weibos, Comments
```



æ³¨æ„ï¼šå¾®åšåˆ†PCå¾®åšå’Œæ‰‹æœºå¾®åšï¼Œä¸¤è€…çš„æ•°æ®å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œè™½ç„¶æ‰‹æœºå¾®åšåœ¨æµè§ˆå™¨ä¸­é¡µé¢çœ‹èµ·æ¥å¾ˆä¸‘ï¼Œä½†æ‰‹æœºå¾®åšæ›´å®¹æ˜“é‡‡é›†ï¼Œ æœ¬æ•™ç¨‹æ˜¯å¯¹**å¾®åšæ‰‹æœºç«¯**è®¾è®¡çš„çˆ¬è™«ï¼Œæ‰‹æœºç«¯å¾®åšé“¾æ¥  https://weibo.cn/ 

### 3.1 ä¸ªäººç®€ä»‹

è·å–æŸç”¨æˆ·ä¸ªäººç®€ä»‹

```python
from weibo_crawler import Profile
import os

#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/ç®€ä»‹.csv'
prof = Profile(csvfile=csvfile, 
                delay=1, 
                cookies=cookies)

prof.get_profile(userid='1087770692') #é™ˆå¤å¾®åšçš„id
```

Run

```
{'nickname': 'é™ˆå¤', 
'gender': 'ç”·', 
'province': 'é‡åº†', 
'brief_introduction': 'è«å¤±å·±é“ï¼Œè«æ‰°ä»–å¿ƒã€‚', 
'birthday': '0001-00-00', 
'vip_level': '7çº§é€Taä¼šå‘˜', 
'authentication': 'æ¼”å‘˜ï¼Œä»£è¡¨ä½œã€Šé¾™é—¨é£ç”²ã€‹ã€Šç”»çš®ã€‹ç­‰ï¼Œè¡Œèµ°çš„åŠ›é‡å‘èµ·è€…', 'labels': 'æ¼”å‘˜'}

```

ç”¨æˆ·idè·å–æ–¹å¼
![](img/ç”¨æˆ·id.png)

### 3.2 è·å–ç²‰ä¸/å…³æ³¨åˆ—è¡¨

å“ªäº›å¾®åšç”¨æˆ·å…³æ³¨äº†é™ˆå¤

```python
from weibo_crawler import Follow
import os

#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/fans.csv'
follow = Follow(csvfile=csvfile, 
                delay=1, 
                cookies=cookies)

#å“ªäº›å¾®åšç”¨æˆ·å…³æ³¨äº†é™ˆå¤
follow.who_follow(userid='1087770692')
```

Run

```
{'uid1': '1879804794', 'uid2': '1087770692', 'crawl_time': '2021-04-30 18:24:40', 'relationship': '1879804794-follow-1087770692'}
{'uid1': '6371190854', 'uid2': '1087770692', 'crawl_time': '2021-04-30 18:24:40', 'relationship': '6371190854-follow-1087770692'}
{'uid1': '7602005193', 'uid2': '1087770692', 'crawl_time': '2021-04-30 18:24:40', 'relationship': '7602005193-follow-1087770692'}
{'uid1': '3227075870', 'uid2': '1087770692', 'crawl_time': '2021-04-30 18:24:40', 'relationship': '3227075870-follow-1087770692'}
```



é™ˆå¤å…³æ³¨äº†å“ªäº›å¾®åšç”¨è´¦å·

```python
#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/chenkun_follow_who.csv'
follow = Follow(csvfile=csvfile, 
                delay=1, 
                cookies=cookies)

#å“ªäº›å¾®åšç”¨æˆ·å…³æ³¨äº†é™ˆå¤
follow.follow_who(userid='1087770692')
```

Run

```
{'uid1': '1087770692', 'uid2': '7451895315', 'crawl_time': '2021-04-30 18:25:30', 'relationship': '7451895315-follow-1087770692'}
{'uid1': '1087770692', 'uid2': '1715351501', 'crawl_time': '2021-04-30 18:25:30', 'relationship': '1715351501-follow-1087770692'}
{'uid1': '1087770692', 'uid2': '1278932711', 'crawl_time': '2021-04-30 18:25:30', 'relationship': '1278932711-follow-1087770692'}
{'uid1': '1087770692', 'uid2': '1299491507', 'crawl_time': '2021-04-30 18:25:30', 'relationship': '1299491507-follow-1087770692'}

```



### 3.3 æŸå¾®åšä¸‹çš„è¯„è®º

è·å–æŸæ¡å¾®åšweibo_idé‡Œçš„è¯„è®ºä¿¡æ¯

```python
from weibo_crawler import Comments
import os

#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/comments.csv'
coms = Comments(csvfile=csvfile, 
                delay=1, 
                cookies=cookies)

# weibo_id='IDl56i8av')
coms.comments(weibo_id='IDl56i8av')
```

Run

```
{'weibo_id': 'IDl56i8av', 'comment_uid': '2249872265', 'like_num': '82', 'create_time': '2020-04-14 23:44:51', 'content': 'æ˜å¤©ï¼Œä½ å¥½ï¼é›·ç¥å±±å…³é—¨å¤§å‰', 'craw_time': '2021-04-30 18:33:13'}
{'weibo_id': 'IDl56i8av', 'comment_uid': '5458366215', 'like_num': '49', 'create_time': '2020-04-14 23:42:37', 'content': 'æ™šå®‰ğŸ’¤ç–«æƒ…å¿«ç‚¹å¥½èµ·æ¥å§', 'craw_time': '2021-04-30 18:33:13'}
{'weibo_id': 'IDl56i8av', 'comment_uid': '6577817093', 'like_num': '29', 'create_time': '2020-04-14 23:42:32', 'content': 'è·ªæ±‚å¤§å®¶æ•‘æ•‘æˆ‘ä»¬ä¸€å®¶ï¼', 'craw_time': '2021-04-30 18:33:13'}

```

**å¾®åšidçš„è·å–æ–¹å¼**

![](img/å¾®åšid.png)

<br>

### 3.4 è·å–å¤šå¾®åš

- get_weibos_by_userid(userid='1087770692')

- get_weibos_by_userid_and_date(userid='1087770692', startdate='2020-01-01', enddate='2020-12-31')

- get_weibos_by_topic_and_date(topic='python', startdate='2020-01-01', enddate='2020-12-31')



#### 3.4.1 get_weibos_by_userid

è·å–æŸæŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰å¾®åšæ•°æ®

```python
from weibo_crawler.weibos import Weibos
import os

#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/1087770692.csv'
WB = Weibos(csvfile=csvfile, 
            delay=1, 
            cookies=cookies)

# userid='1087770692'
WB.get_weibos_by_userid(userid='1087770692')

```

Run

```
{'uid': '1087770692', 'weibo_id': 'Kdiasmwfx', 'product': '', 'ratescore': 0, 'content': 'Aç»„è½¬Bç»„ï¼Œä¹‹åè½¬å›Aã€‚', 'like_num': '10820', 'repost_num': '8115', 'comment_num': '8665', 'create_time': 'ä»Šå¤© 13:57', 'crawl_time': '2021-04-30 18:37:53', 'device': '', 'img': None, 'raw_img': '', 'location': '', 'video_link': None, 'orinin_link': None}

{'uid': '1087770692', 'weibo_id': 'KcZQbvplr', 'product': '', 'ratescore': 0, 'content': 'è½¬å‘äº†\xa0å±±ä¸‹å­¦å ‚\xa0çš„å¾®åš:#è¡¨æ¼”ä¸è¡Œä¸ºè‰ºæœ¯##å±±ä¸‹å­¦å ‚# 2020æ–°äººç­â€œç¾æœ¯é¦†è®¡åˆ’â€çš„ä¸¤æ—¥ï¼Œå­¦å‘˜ä»¬æ¥åˆ°@çº¢ç –ç¾æœ¯é¦† ï¼Œå…±åŒå‚è§‚â€œè©¹å§†æ–¯Â·æÂ·æ‹œå°”æ–¯ï¼š#å®Œç¾æ—¶åˆ»# â€å±•è§ˆï¼Œå¹¶ä¸çº¢ç –ç¾æœ¯é¦†æºæ‰‹å†ç°è¿™ä½ä¼ å¥‡è‰ºæœ¯å®¶çš„ä¸‰ä»¶å‚ä¸å¼è¡Œä¸ºè¡¨æ¼”ä½œå“ã€‚çº¢ç –ç¾æœ¯é¦†é«˜çº§ç­–å±•äºº Jonas Stampe ä¸ºæ¯ä¸ªä½œå“æŒ‡å¯¼ã€‚â€œç¼“æ…¢ã€æ”¾æ¾ï¼Œä½ ä»¬è¿™æ ·å¾ˆç¾ã€‚â€ä»–é¼“åŠ±...å…¨æ–‡\xa0[ç»„å›¾å…±18å¼ ]åŸå›¾\xa0èµ[218]\xa0åŸæ–‡è½¬å‘[7107]\xa0åŸæ–‡è¯„è®º[44]è½¬å‘ç†ç”±:è½¬å‘å¾®åš', 'like_num': '8266', 'repost_num': '7082', 'comment_num': '7549', 'create_time': '04æœˆ28æ—¥ 15:18', 'crawl_time': '2021-04-30 18:37:53', 'device': '', 'img': 'https://h5.sinaimg.cn/upload/2016/05/26/319/5337.gif', 'raw_img': 'https://weibo.cn/mblog/oripic?id=KcZQbvplr&u=5337', 'location': '', 'video_link': None, 'orinin_link': 'https://weibo.cn/comment/KcZpdwdlK?rl=1#cmtfrm'}

{'uid': '1087770692', 'weibo_id': 'KcQkm0cFm', 'product': '', 'ratescore': 0, 'content': 'çªç„¶å‘ç°ï¼Œä¸€ç´¯äº†å°±æ‰¾åƒçš„è§†é¢‘çœ‹ã€‚å®Œå…¨ä¸‹æ„è¯†çš„ï¼Œå·²ç»å¥½ä¸€æ®µæ—¶é—´äº†ã€‚', 'like_num': '21261', 'repost_num': '7766', 'comment_num': '11419', 'create_time': '04æœˆ27æ—¥ 15:05', 'crawl_time': '2021-04-30 18:37:53', 'device': '', 'img': '//h5.sinaimg.cn/m/emoticon/icon/default/d_wabishi-816c4e8890.png', 'raw_img': 'https://weibo.cn/mblog/oripic?id=KcQkm0cFm&u=d_wabishi-816c4e8890', 'location': '', 'video_link': None, 'orinin_link': None}

```



#### 3.4.2 get_weibos_by_userid_and_date

è·å–æŸæŒ‡å®šç”¨æˆ·æŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„å¾®åšæ•°æ®

```python
from weibo_crawler.weibos import Weibos
import os

#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/1087770692date.csv'

WB = Weibos(csvfile=csvfile, 
            delay=1, 
            cookies=cookies)

# æŸç”¨æˆ·æŒ‡å®šæ—¥æœŸçš„å¾®åšæ•°æ®
WB.get_weibos_by_userid_and_date(userid='1087770692', 
                                 startdate='2020-01-01', 
                                 enddate='2020-12-31')
```

Run

```
{'uid': '1087770692', 'weibo_id': 'Iquq5giZd', 'product': '', 'ratescore': 0, 'content': 'åˆ†äº«å›¾ç‰‡ \xa0[ç»„å›¾å…±2å¼ ]åŸå›¾', 'like_num': '37582', 'repost_num': '7136', 'comment_num': '7772', 'create_time': '2020-01-21 11:34:45\xa0æ¥è‡ªç»¿æ´²APP', 'crawl_time': '2021-04-30 18:40:43', 'device': 'ç»¿æ´²APP', 'img': 'http://wx4.sinaimg.cn/wap180/40d61044gy1gb41ple6h0j20yi1azb29.jpg', 'raw_img': 'https://weibo.cn/mblog/oripic?id=Iquq5giZd&u=40d61044gy1gb41ple6h0j20yi1azb29', 'location': '', 'video_link': None, 'orinin_link': None}

{'uid': '1087770692', 'weibo_id': 'IqdeJlfr9', 'product': '', 'ratescore': 0, 'content': 'è¿‡èŠ‚å‡ å¤©è¦ç»ƒç»ƒé’¢ç¬”å­—äº†', 'like_num': '25958', 'repost_num': '5462', 'comment_num': '6298', 'create_time': '2020-01-19 15:50:05', 'crawl_time': '2021-04-30 18:40:43', 'device': '', 'img': None, 'raw_img': '', 'location': '', 'video_link': None, 'orinin_link': None}

{'uid': '1087770692', 'weibo_id': 'IphT4lwlZ', 'product': '', 'ratescore': 0, 'content': 'ç”Ÿæ´»æ˜¯è‡ªå·±çš„ä¸ä»…ä»…å­˜åœ¨äºåˆ«äººçš„è°ˆè®ºä¸­è¿‡å¥½è‡ªå·±çš„éšå–œåˆ«äººçš„', 'like_num': '44829', 'repost_num': '7008', 'comment_num': '6711', 'create_time': '2020-01-13 13:50:09', 'crawl_time': '2021-04-30 18:40:43', 'device': '', 'img': None, 'raw_img': '', 'location': '', 'video_link': None, 'orinin_link': None}

```



#### 3.4.3 get_weibos_by_topic_and_date

è·å–æŒ‡å®šè¯é¢˜ã€æŒ‡å®šæ—¥æœŸèŒƒå›´çš„å¾®åš

```python
from weibo_crawler.weibos import Weibos
import os

#å¦‚æœç¨‹åºå¤±è´¥ï¼Œéœ€è¦ä¼ å…¥ä½ çš„å¾®åšcookies
cookies = ''

# csvæ–‡ä»¶è·¯å¾„
csvfile = os.getcwd()+'/1087770692date.csv'

WB = Weibos(csvfile=csvfile, 
            delay=1, 
            cookies=cookies)

# æŸæŒ‡å®šè¯é¢˜æ—¥æœŸèŒƒå›´å†…çš„å¾®åšæ•°æ®
WB.get_weibos_by_topic_and_date(topic='python', 
                                startdate='2020-01-01', 
                                enddate='2020-12-31')
```

Run

```
{'uid': '6438471311', 'weibo_id': 'InwK8nQZT', 'product': '', 'ratescore': 0, 'content': 'è™¾å°¾æ‹Œé¢è¦å»å£³:æ˜åä¸¤å¤©æœ¬å­¦ç•œå°†æ¸¡åŠ«æ‰¹åˆ¤æ€§æ€ç»´pythonå“ç‰Œä¼ æ’­è½®ç•ªè½°ç‚¸å¸Œæœ›æˆ‘å¯ä»¥è‹Ÿä¸‹æ¥', 'like_num': '0', 'repost_num': '0', 'comment_num': '0', 'create_time': '2020-01-01 23:58:44\xa0æ¥è‡ªé€¢è€ƒå¿…è¿‡çš„äºº', 'crawl_time': '2021-04-30 18:43:25', 'device': 'é€¢è€ƒå¿…è¿‡çš„äºº', 'img': 'https://h5.sinaimg.cn/upload/2016/05/26/319/5338.gif', 'raw_img': 'https://weibo.cn/mblog/oripic?id=InwK8nQZT&u=5338', 'location': '', 'video_link': None, 'orinin_link': None}

{'uid': '6023446153', 'weibo_id': 'InwJreRSg', 'product': '', 'ratescore': 0, 'content': 'å°å°ä¹¦æŸ“:2020å¹´ç¬¬ä¸€å¤©å°±çŒ®ç»™äº†PythonçœŸå¥½ï¼åŸå›¾', 'like_num': '2', 'repost_num': '0', 'comment_num': '2', 'create_time': '2020-01-01 23:57:01\xa0æ¥è‡ªnova4è‡ªæ‹æç‚¹å…¨é¢å±', 'crawl_time': '2021-04-30 18:43:25', 'device': 'nova4è‡ªæ‹æç‚¹å…¨é¢å±', 'img': '//h5.sinaimg.cn/m/emoticon/icon/default/d_hehe-0be7e6251f.png', 'raw_img': 'https://weibo.cn/mblog/oripic?id=InwJreRSg&u=d_hehe-0be7e6251f', 'location': '', 'video_link': None, 'orinin_link': None}

{'uid': '5815948537', 'weibo_id': 'InwHm8QV3', 'product': '', 'ratescore': 0, 'content': 'åä¸­å¶ä¹¦:æ˜å¤©å¼€å§‹å­¦PythonåŸå›¾', 'like_num': '0', 'repost_num': '0', 'comment_num': '0', 'create_time': '2020-01-01 23:51:53\xa0æ¥è‡ªnova4è‡ªæ‹æç‚¹å…¨é¢å±', 'crawl_time': '2021-04-30 18:43:25', 'device': 'nova4è‡ªæ‹æç‚¹å…¨é¢å±', 'img': 'https://h5.sinaimg.cn/upload/2016/05/26/319/donate_btn_s.png', 'raw_img': 'https://weibo.cn/mblog/oripic?id=InwHm8QV3&u=donate_btn_s', 'location': '', 'video_link': None, 'orinin_link': None}

```



# å››ã€cookies

Weibo_crawlerå†…ç½®äº†ä¸€ä¸ªcookieså€¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹cookiesè®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²å³å¯ï¼› 

å¦‚æœç¨‹åºè·‘ä¸å‡ºæ¥ç»“æœï¼ŒæŠ¥é”™ï¼Œéœ€è¦ä¼ å…¥è‡ªå·±çš„å¾®åšcookiesã€‚



ç‚¹å‡»æ‰‹æœºweibo  https://weibo.cn  ï¼Œ ç™»å…¥è´¦å·å¯†ç å

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·Networké¢æ¿
2. åˆ·æ–°é¡µé¢ï¼Œæ‰¾åˆ°å«æœ‰weiboçš„ä»»æ„ç½‘å€ï¼Œè·å–cookies

![](img/cookies.jpg)


<br>


## å¦‚æœ

å¦‚æœæ‚¨æ˜¯ç»ç®¡äººæ–‡ç¤¾ç§‘ä¸“ä¸šèƒŒæ™¯ï¼Œç¼–ç¨‹å°ç™½ï¼Œé¢ä¸´æµ·é‡æ–‡æœ¬æ•°æ®é‡‡é›†å’Œå¤„ç†åˆ†æè‰°å·¨ä»»åŠ¡ï¼Œä¸ªäººå»ºè®®å­¦ä¹ [ã€Špythonç½‘ç»œçˆ¬è™«ä¸æ–‡æœ¬æ•°æ®åˆ†æã€‹](https://ke.qq.com/course/482241?tuin=163164df)è§†é¢‘è¯¾ã€‚ä½œä¸ºæ–‡ç§‘ç”Ÿï¼Œä¸€æ ·ä¹Ÿæ˜¯ä»ä¸¤çœ¼ä¸€æŠ¹é»‘å¼€å§‹ï¼Œè¿™é—¨è¯¾ç¨‹æ˜¯ç”¨äº”å¹´æ—¶é—´å‡ç¼©å‡ºæ¥çš„ã€‚è‡ªè®¤ä¸ºè®²çš„å¾ˆé€šä¿—æ˜“æ‡‚o(*ï¿£ï¸¶ï¿£*)oï¼Œ

- pythonå…¥é—¨
- ç½‘ç»œçˆ¬è™«
- æ•°æ®è¯»å–
- æ–‡æœ¬åˆ†æå…¥é—¨
- æœºå™¨å­¦ä¹ ä¸æ–‡æœ¬åˆ†æ
- æ–‡æœ¬åˆ†æåœ¨ç»ç®¡ç ”ç©¶ä¸­çš„åº”ç”¨

æ„Ÿå…´è¶£çš„ç«¥é‹ä¸å¦¨ æˆ³ä¸€ä¸‹[ã€Špythonç½‘ç»œçˆ¬è™«ä¸æ–‡æœ¬æ•°æ®åˆ†æã€‹](https://ke.qq.com/course/482241?tuin=163164df)è¿›æ¥çœ‹çœ‹~

<br>

## æ›´å¤š

- [Bç«™:å¤§é‚“å’Œä»–çš„python](https://space.bilibili.com/122592901/channel/detail?cid=66008)

- å…¬ä¼—å·ï¼šå¤§é‚“å’Œä»–çš„python

- [çŸ¥ä¹ä¸“æ ï¼šæ•°æ®ç§‘å­¦å®¶](https://zhuanlan.zhihu.com/dadeng)


![](img/å…¬ä¼—å·.png)

