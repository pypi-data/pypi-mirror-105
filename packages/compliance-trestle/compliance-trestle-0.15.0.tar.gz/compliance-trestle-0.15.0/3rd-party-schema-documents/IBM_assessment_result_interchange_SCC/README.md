# Schema of Assessment Results for Interchange with SCC

This document depicts the structure and guidelines for creating OSCAL result object which would be generated by various transformers for different tools such as tanium to OSCAL and OSCO to OSCAL. PVPs such as toolchain that directly generate OSCAL result for sending to SCC Exchange API should follow this structure and guidelines.

The overall object will be a *results* element of OSCAL Assessment Result schema warpped in an outer json object as shown below.

```
{
    results: [
        {
            result object ...
        },
        {
            result object ...
        }
    ]
}
```

Each result object represents one assessment scan and should have the required properties as per OSCAL schema. The *start* and *end* represents the start and end datetime of evidence collection activity. The *end* is optional. In addition to these, the result object may contain details about inventory, list of observations (checks) for each inventory, and findings for profile level controls (such as NIST).

```
{
    "uuid": "cd54e9bf-f4d3-45d6-ae3b-6e8255847dc2",
    "title": "Tanium",
    "description": "Tanium",
    "start": "2021-04-05T20:19:11.000+00:00", 
    "end": "2021-04-05T20:19:11.000+00:00", 
    "local-definitions": { },
    "reviewed-controls": { },
    "observations": { },
    "findings": { }
}
```

The inventory should be included in *local-definitions* if observations are being reported, but can be omitted if only *findings* are being reported. As *reviewwed-controls* is required as per OSCAL schema, an empty object should be included if only observations are being reported. Optionally, the controls for which the status is being reported in *findings* can be captured here. The actual assessment checks being performed on different inventory items should be captured under *observations*. This can be omitted if only *findings* are being reported. As *findings* is required as per OSCAL schema, an empty object can be included if only observations are being reported and no profile controls are being assessed. Otherwise, findings should include the status of profile controls.

## General Guidance

1. All the properties in the source result (tool specific format) should be represented as properties of the right objects in OSCAL such as inventory-items, observations, etc. The properties should have a tool specific namespace to convey that the property names are exactly same as what is coming from specific tools.

1. Not everything from the non-OSCAL results are relevant (required) by SCC. The relevant properties MUST have SCC specific *class* such as scc_inventory_item_id, scc_result, etc. This will help SCC identify corresponding information from different tools and handle them appropriately. SCC MUST store the original prperty names so that when these are retrived by tools later, they can get back the same name-value pairs as was there in the input data.

1. There must be a pre-defined set of properties (class values) from SCC for each result object compoennt such as *inventory-items*, *components*, *observations*, etc.

1. A property value MUST be a string of appropriate format.

## Inventory

1. Inventory is captured under *local-definitions* in result object. local-definitions can be used to represent inventory items, components, users, etc. For our purposes only components and inventory-items will be used. Components should be used to represent software, services, etc. whereas inverntory-items represent specific machines, VMs, network devices, etc. The inventory items should be associated to a component through *implemented-components* as shown below.

   ```
   "local-definitions": {
       "components": {
           "b3e243a1-4660-4f5a-aa85-159b4b2d69ce": {
               "type": "Windows 10",
               "title": "Windows 10",
               "description": "Windows 10",
               "status": {
                   "state": "operational"
               }
           }
       },
       "inventory-items": [
           {
               "uuid": "c9fb63cf-d21e-4584-88f8-44d67ea33ba0",
               "description": "inventory",
               "props": [
                   {
                       "name": "Computer Name",
                       "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                       "value": "cmp-wn-2106.demo.tanium.local",
                       "class": "scc_inventory_item_id"
                   },
                   {
                       "name": "IP Address",
                       "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                       "value": "fe80::3cd5:564b:940e:49ab, 10.8.69.11"
                   },
                   {
                       "name": "Count",
                       "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                       "value": "1"
                   },
                   {
                       "name": "Age",
                       "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                       "value": "600"
                   }
               ],
               "implemented-components": [
                   {
                       "component-uuid": "b3e243a1-4660-4f5a-aa85-159b4b2d69ce"
                   }
               ]
           },
           ...
       ]
   }
   ```

1. Inventory items have one required property with class *scc_inventory_item_id* as shown above. Similalry in some other tool's result the scc_inventory_item_id may be specified through some other property. It is the job of the transformation code to appropriately specify class values for required properties. As shown above, non-mandatory property such as *count* from native result does not have any class specified.

1. The *type* of the inventory item is specified by linking it to *component* via *implemented-components*.

## Observation

1. Loosely speaking, an *observation* object equates with results from a goal check, and the observation is uniquely identified by a uuid, e.g.,

   ```
   {
       "uuid" : "00000000-0000-4000-9999-000000000016",
       "description" : "xccdf_org.cisecurity.benchmarks_rule_1.1.1_L1_Ensure_Enforce_password_history_is_set_to_24_or_more_passwords",
       ...
   }
   ```

1. A sample observation object generated from tanium result looks like -

   ```
   {
       "uuid": "d8bd1785-b95f-45c9-9fa8-32a362845102",
       "description": "xccdf_org.cisecurity.benchmarks_rule_1.1.1_L1_Ensure_Enforce_password_history_is_set_to_24_or_more_passwords",
       "props": [
           {
               "name": "Benchmark",
               "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
               "value": "CIS Microsoft Windows 10 Enterprise Release 1803 Benchmark",
               "class": "scc_goal_type"
           },
           {
               "name": "Benchmark Version",
               "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
               "value": "1.5.0.1",
               "class": "scc_goal_version"
           },
           {
               "name": "ID",
               "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
               "value": "xccdf_org.cisecurity.benchmarks_rule_1.1.1_L1_Ensure_Enforce_password_history_is_set_to_24_or_more_passwords",
               "class": "scc_goal_name_id"
           },
           {
               "name": "Result",
               "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
               "value": "pass",
               "class": "scc_result"
           }
       ],
       "methods": [
           "TEST-AUTOMATED"
       ],
       "subjects": [
           {
               "uuid-ref": "c9fb63cf-d21e-4584-88f8-44d67ea33ba0",
               "type": "inventory-item"
           }
       ],
       "collected": "2021-04-12T13:26:21.000+00:00"
   }
   ```

1. An obsevration has four required properties -

   - *scc_goal_type* - specifies the document for check such as CIS benchmarks or NIST STIGs.
   - *scc_goal_version* - gives the version of the goal i.e., CIS benchmark version used for check.
   - *scc_goal_name_id* - gives the speciifc goal check (rule) that was assessed from the scc_goal_type.
   - *scc_result* - gives the outcome of performing the check. Possible values are - "pass", "fail", "skip", "error".

1. Targets such as systems or services MUST be a *subject* in the observation, which MUST be identified by a *uuid-ref* value pointing to the subject in local-definitions.

## Finding

1. A *finding* represents the assessemnt of a profile control such as NIST 800-53: AC-1 and the related observations. A sample finding object generated from tanium result looks like -

   ```
   {
       "uuid": "cde35fad-3922-4046-8ef8-830e77ffd75a",
       "title": "800-53: IA-5",
       "description": "800-53: IA-5",
       "target": {
           "type": "statement-id",
           "id-ref": "800-53: IA-5",
           "props": [
               {
                   "name": "Profile",
                   "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                   "value": "Windows 10 - NIST 800-53",
                   "class": "scc_profile"
               },
               {
                   "name": "Version",
                   "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                   "value": "version: 1",
                   "class": "scc_profile_version"
               },
               {
                   "name": "Custom ID",
                   "ns": "http://ibm.github.io/compliance-trestle/schemas/oscal/ar/tanium",
                   "value": "800-53: IA-5",
               }
           ],
           "status": "not-satisfied"
       },
       "related-observations": [
           {
               "observation-uuid": "d8bd1785-b95f-45c9-9fa8-32a362845102"
           },
           {
               "observation-uuid": "d06c6f13-5006-4e2d-b3f3-5cdb577473b1"
           }
       ]
   }
   ```

1. A finding has two required property *scc_profile* that gives the name of the profile whose control is specified in "id-ref", and *scc_profile_version*.
