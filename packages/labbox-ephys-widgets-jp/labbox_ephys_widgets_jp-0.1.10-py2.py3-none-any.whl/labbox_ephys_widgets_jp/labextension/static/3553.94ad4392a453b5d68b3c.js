(self.webpackChunklabbox_ephys_widgets_jp=self.webpackChunklabbox_ephys_widgets_jp||[]).push([[3553],{83553:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>U,useWorkspaceRoute:()=>I});var t=s(47033),a=s(45185),o=s(56271),c=s.n(o),i=s(49287),n=s(5597),d=s(45),g=s(40390),p=s.n(g);const u=(e,r)=>{const s=e.pathname.split("/"),t=p().parse(e.search.slice(1)).workspace||"default",a=null==r?void 0:r.defaultFeedId,o=t.startsWith("workspace://")?t:a?`workspace://${a}/${t}`:void 0,c=s[1]||"recordings";if(!["recordings","recording","sorting"].includes(c))throw Error(`Invalid page: ${c}`);switch(c){case"recordings":return{workspaceUri:o,page:c};case"recording":return{workspaceUri:o,page:c,recordingId:s[2]};case"sorting":return{workspaceUri:o,page:c,recordingId:s[2]||"",sortingId:s[3]||""};default:return{workspaceUri:o,page:"recordings"}}};var h=e=>{const r=Object.keys(e);return 0===r.length?"":"?"+r.map((r=>encodeURIComponent(r)+"="+encodeURIComponent(e[r]))).join("&")},l=s(96734),f=s(34446),m=s(93633);const k={palette:{primary:l.Z,secondary:f.Z},overrides:{MuiAccordionSummary:{root:{"&$expanded":{minHeight:0,maxHeight:30,paddingTop:10},minHeight:0}},MuiToolbar:{regular:{minHeight:48,"@media(min-width:600px)":{minHeight:48}}},MuiTabs:{root:{minHeight:30,maxHeight:30}},MuiTab:{root:{minHeight:30,maxHeight:30,padding:"6px 0px"}}}},w=(0,m.Z)(k);var b=s(13534);const I=(e,r,s)=>{const t=(0,o.useMemo)((()=>t=>{const a=u(r.location,{}),o=(e=>{const r={};switch(e.workspaceUri&&(r.workspace=e.workspaceUri),e.page){case"recordings":return{pathname:"/",search:h(r)};case"recording":return{pathname:`/recording/${e.recordingId}`,search:h(r)};case"sorting":return{pathname:`/sorting/${e.recordingId}/${e.sortingId}`,search:h(r)}}})(((e,r)=>{let s=e;switch(r.type){case"gotoRecordingsPage":s={page:"recordings",workspaceUri:e.workspaceUri};break;case"gotoRecordingPage":s={page:"recording",recordingId:r.recordingId,workspaceUri:e.workspaceUri};break;case"gotoSortingPage":s={page:"sorting",recordingId:r.recordingId,sortingId:r.sortingId,workspaceUri:e.workspaceUri}}return s})(Object.assign(Object.assign({},a),{workspaceUri:s}),t));o.pathname===e.pathname&&o.search===e.search||r.push(o)}),[e,r]);return[(0,o.useMemo)((()=>u(e,{})),[e]),t]},U=({workspaceUri:e,onWorkspaceRouteChanged:r})=>{const s=(0,a.usePlugins)(),g=(0,o.useCallback)((e=>{e.forEach((e=>{e.action&&k(e.action)}))}),[]),{feedUri:p,workspaceName:u}=(0,n.x)(e),h=(0,o.useMemo)((()=>({workspaceName:u||""})),[u]),{appendMessages:l,loadedInitialMessages:f}=(0,a.useSubfeed)({feedUri:p,subfeedName:h,onMessages:g}),[m,k]=(0,o.useReducer)(d.Z,{recordings:[],sortings:[]}),U=(0,o.useCallback)((e=>{l([{action:e}])}),[l]),[v,M]=(0,o.useState)(null),[H,x]=(0,o.useState)(void 0),[R,E]=(0,o.useState)(void 0),[S,y]=(0,o.useState)(0),C=c().useCallback((e=>{M(e)}),[]);(0,o.useEffect)((()=>{v&&(H!==v.offsetWidth&&x(v.offsetWidth),R!==v.offsetHeight&&E(v.offsetHeight))}),[v,H,R,x,E,S]),function(e,r){const s=(0,o.useRef)();(0,o.useEffect)((()=>{s.current=e})),(0,o.useEffect)((()=>{{const e=setInterval((function(){void 0!==(null==s?void 0:s.current)&&(null==s||s.current())}),r);return()=>clearInterval(e)}}),[r])}((()=>{y(S+1)}),1e3);const[j,W]=(0,o.useState)({pathname:"",search:"?"}),[$,Z]=(0,o.useState)([]),_=(0,o.useMemo)((()=>({location:j,push:e=>{Z([...$,j]),W(e)}})),[j,$]),[A,P]=I(j,_,e);return(0,o.useEffect)((()=>{r&&r(A)}),[A,r]),c().createElement(t.MuiThemeProvider,{theme:w},c().createElement("div",{ref:C,className:"WorkspaceViewWrapper",style:{position:"absolute",left:0,right:0,top:0,bottom:0}},c().createElement(b.Z,Object.assign({},{defaultFeedId:"",workspace:m,workspaceDispatch:U,plugins:(0,i.qG)(s),workspaceRoute:A,workspaceRouteDispatch:P,width:H||700,height:R||700}))))}},96734:(e,r,s)=>{"use strict";s.d(r,{Z:()=>t});const t={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",A100:"#b388ff",A200:"#7c4dff",A400:"#651fff",A700:"#6200ea"}}}]);