Metadata-Version: 2.1
Name: rabbitmq2psql-as-json
Version: 1.0.0
Summary: Asynchronous RabbitMQ consumer job library for PostgreSQL
Home-page: https://github.com/mantis-software-company/async-cj
Author: Furkan Kalkan
Author-email: furkankalkan@mantis.com.tr
License: UNKNOWN
Platform: all
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Topic :: Internet
Classifier: Topic :: Software Development
Classifier: Topic :: Software Development :: Libraries
Classifier: Topic :: Software Development :: Testing
Classifier: Intended Audience :: Developers
Classifier: Operating System :: MacOS
Classifier: Operating System :: POSIX
Classifier: Operating System :: Microsoft
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.5
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Requires-Python: >3.5.*, <4
Description-Content-Type: text/markdown
Requires-Dist: psycopg2
Requires-Dist: aio-pika

# rabbitmq2psql-as-json

rabbitmq2psql-as-json is ready to use, basic asynchronous RabbitMQ consumer job library for PostgreSQL. It stops when queue is empty, so it can be useful for cron jobs, unit tests, CI/CD environments and production environments has slow datastream.

## Usage
```py
import os
import asyncio
from rabbitmq2psql-as-json import consume

if __name__ == '__main__':  
    config = {  
      "mq_host": os.environ.get('MQ_HOST'),  
	  "mq_port": int(os.environ.get('MQ_PORT')),  
	  "mq_vhost": os.environ.get('MQ_VHOST'),  
	  "mq_user": os.environ.get('MQ_USER'),  
	  "mq_pass": os.environ.get('MQ_PASS'),  
	  "mq_queue": os.environ.get('MQ_QUEUE'),  
	  "db_host": os.environ.get('DB_HOST'),  
	  "db_port": int(os.environ.get('DB_PORT')),  
	  "db_user": os.environ.get('DB_USER'),  
	  "db_pass": os.environ.get('DB_PASS'),  
	  "db_database": os.environ.get('DB_DATABASE')  
    }  

sql_template = """insert into logs (body) values (%s);"""  

loop = asyncio.get_event_loop()  
loop.run_until_complete(
	consume(loop=loop, consumer_pool_size=10, sql_template=sql_template, config=config)
)  
loop.close()
```


