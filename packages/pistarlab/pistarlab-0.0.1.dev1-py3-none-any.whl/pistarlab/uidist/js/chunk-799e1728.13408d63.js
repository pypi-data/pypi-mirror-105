(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-799e1728"],{8467:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("New Agent Task")]),n("b-modal",{attrs:{id:"modal-launch-task",title:"Launching Task",size:"lg","hide-footer":!0,"hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0}},[n("TaskLoad",{attrs:{uid:e.newTaskId}})],1),n("b-modal",{attrs:{id:"modal-select-envspec",title:"Select Environment",size:"lg"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var a=t.cancel;return[n("b-button",{attrs:{variant:"secondary"},on:{click:function(e){return a()}}},[e._v("Cancel")])]}}])},[n("EnvSelector",{on:{click:function(t){return e.selectEnvSpec(t)}}})],1),n("b-modal",{attrs:{id:"modal-select-agent",title:"Select Agent",size:"lg"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var a=t.cancel;return[n("b-button",{attrs:{variant:"secondary"},on:{click:function(e){return a()}}},[e._v("Cancel")])]}}])},[n("AgentSelector",{on:{click:function(t){return e.loadAgent(t)}}})],1),n("b-modal",{attrs:{id:"modal-configure-envspec",title:"Config Environment",size:"lg"}},[n("b-container",{attrs:{fluid:""}},[n("b-row",[n("b-col",[n("div",[e._v(" Env Config "),n("b-textarea",{staticClass:"mt-3",attrs:{rows:"6","max-rows":"10","no-auto-shrink":"",size:"sm"},model:{value:e.envSpecKwargOverrides,callback:function(t){e.envSpecKwargOverrides=t},expression:"envSpecKwargOverrides"}})],1)])],1)],1)],1),n("b-modal",{attrs:{id:"modal-full-config",title:"Config Output",size:"lg"}},[n("b-container",{attrs:{fluid:""}},[n("b-row",[n("b-col",[n("div",[n("b-textarea",{staticClass:"mt-3",attrs:{rows:"20","max-rows":"40",size:"sm"},model:{value:e.fullConfig,callback:function(t){e.fullConfig=t},expression:"fullConfig"}})],1)])],1)],1)],1),n("b-modal",{attrs:{id:"modal-configure-agent",title:"Configure Agent",size:"lg"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){return[n("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.updateAgentConfig()}}},[e._v("Ok")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(t){return e.removeAgent()}}},[e._v("Remove Agent")])]}}])},[n("b-tabs",{attrs:{"content-class":"mt-4",justified:""}},[n("b-tab",{attrs:{title:"Session Configuration"}},[n("div",{staticClass:"d-flex flex-wrap"},e._l(e.agentSessionConfigFields,(function(t){return n("b-form-group",{key:t.key,staticClass:"ml-2",staticStyle:{width:"320px"},attrs:{label:t.label,description:t.description}},["boolean"==t.type?n("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:e.agentSessionConfig[t.key],callback:function(n){e.$set(e.agentSessionConfig,t.key,n)},expression:"agentSessionConfig[item.key]"}}):n("b-form-input",{staticClass:"mt-1",attrs:{type:t.type,size:"sm"},model:{value:e.agentSessionConfig[t.key],callback:function(n){e.$set(e.agentSessionConfig,t.key,n)},expression:"agentSessionConfig[item.key]"}})],1)})),1)]),n("b-tab",{attrs:{title:"Agent Configuration"}},[n("ParamEditor",{attrs:{interfaceFilter:"run",buttonText:"Save",params:e.selectedAgentParams,values:e.agentRunConfig},on:{update:function(t){e.agentRunConfig=t}}})],1),n("b-tab",{attrs:{title:"Environment Wrappers (BROKEN)"}},[n("strong",[e._v("WARNING wrappers currently not working. This wrapper need to be updated to support multi agent env interfaces")]),n("p",[e._v("Please select wrappers in the order they will be added the the environment")]),n("b-form-checkbox-group",{attrs:{options:e.wrapperOptions,name:"wrappers",stacked:""},model:{value:e.agentWrappers,callback:function(t){e.agentWrappers=t},expression:"agentWrappers"}}),e._l(e.agentWrappers,(function(t,a){return n("div",{key:t},[n("div",{},[e._v(" "+e._s(a)+" - "+e._s(e.wrappers[t]["entry_point"])+" ")])])}))],2)],1)],1),n("b-modal",{attrs:{id:"assign-player-modal",title:"Assign Player"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var a=t.cancel;return[n("b-button",{attrs:{variant:"secondary"},on:{click:function(e){return a()}}},[e._v("Cancel")])]}}])},[n("b-container",{attrs:{fluid:""}},[n("b-row",[n("b-col",[null!=e.currentPlayerId?n("div",[e._v(" "+e._s(e.envPlayers[e.currentPlayerId].id)+" "),e._l(e.agents,(function(t,a){return n("div",{key:a,staticClass:"m-2"},[n("b-button",{on:{click:function(t){return e.assignPlayerToAgent(e.currentPlayerId,a)}}},[e._v(e._s(t.ident))])],1)}))],2):e._e()])],1)],1)],1),n("b-modal",{attrs:{id:"modal-config",title:"Run Configuration",size:"lg"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var a=t.ok;return[n("b-button",{attrs:{variant:"primary"},on:{click:function(e){return a()}}},[e._v("Ok")])]}}])},[n("div",{staticClass:"d-flex flex-wrap mb-4"},e._l(e.rlSessionConfigFields,(function(t){return n("b-form-group",{key:t.key,staticClass:"ml-2",staticStyle:{width:"300px"},attrs:{label:t.label,description:t.description}},["boolean"==t.type?n("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:e.sessionConfig[t.key],callback:function(n){e.$set(e.sessionConfig,t.key,n)},expression:"sessionConfig[item.key]"}}):n("b-form-input",{staticClass:"mt-1",attrs:{type:t.type,size:"sm"},model:{value:e.sessionConfig[t.key],callback:function(n){e.$set(e.sessionConfig,t.key,n)},expression:"sessionConfig[item.key]"}})],1)})),1)]),n("div",[n("b-container",{attrs:{fluid:""}},[n("h3",[n("i",{staticClass:"fas fa-gamepad"}),e._v(" Environment")]),n("div",{staticClass:"mt-4"}),n("b-row",[n("b-col",[e.envSpec?n("div",[n("b-card",{staticClass:"card-shadow card-flyer"},[n("b-container",{attrs:{fluid:""}},[n("b-row",[n("b-col",{staticClass:"text-center  align-self-center",attrs:{cols:"3"}},[n("b-card-img",{staticStyle:{"max-height":"200px",width:"auto"},attrs:{src:e.appConfig.API_URL+"/api/env_preview_image/"+e.envSpec.environment.ident,alt:""}})],1),n("b-col",[n("b-container",[n("b-row",[n("b-col",[n("div",{staticClass:"mt-auto"},[n("div",{staticClass:"mb-4"},[n("h3",[e._v(e._s(e.envSpec.ident))])]),n("div",{staticClass:"data_label"},[e._v("Environment: "+e._s(e.envSpec.environment.ident))]),n("div",{staticClass:"data_label"},[e._v("Type: "+e._s(e.envSpec.envType))]),e.envMeta.num_players?n("div",{staticClass:"data_label"},[e._v("Num Agents: "+e._s(e.envMeta.num_players)+" ")]):e._e(),n("div",{staticClass:"data_label"},[n("b-modal",{attrs:{id:"show-obvdetails",size:"lg",scrollable:""}},[e.envMeta&&e.envMeta.observation_spaces?n("span",[n("pre",[e._v(" "+e._s(e.envMeta.observation_spaces))])]):n("span",[e._v("No observation spaces defined")])]),n("b-link",{directives:[{name:"b-modal",rawName:"v-b-modal.show-obvdetails",modifiers:{"show-obvdetails":!0}}],attrs:{variant:"secondary",size:"sm"}},[e._v("Observation Space Details")])],1),n("div",{staticClass:"data_label"},[n("b-modal",{attrs:{id:"show-actdetails",size:"lg",scrollable:""}},[e.envMeta&&e.envMeta.action_spaces?n("span",[n("pre",[e._v("                                                                    "+e._s(e.envMeta.action_spaces)+"\n                                                                    ")])]):n("span",[e._v("No action spaces defined")])]),n("b-link",{directives:[{name:"b-modal",rawName:"v-b-modal.show-actdetails",modifiers:{"show-actdetails":!0}}],attrs:{variant:"secondary",size:"sm"}},[e._v("Action Space Details")])],1)])]),n("b-col",[n("b-container",{staticClass:"border-left"},[n("div",[n("div",{staticClass:"overflow-auto",staticStyle:{"max-height":"250px"}},[n("h3",[e._v("Players")]),n("hr"),e._l(e.envPlayers,(function(t,a){return n("b-row",{key:a,staticClass:"m-0 mb-2"},[n("b-col",[e._v(e._s(t.id))]),n("b-col",[null!=t.agent?n("span",[e._v(" "+e._s(e.agents[t.agent].ident)+" ")]):n("span",[e._v(" Unassigned ")])]),n("b-col",[n("b-link",{attrs:{size:"sm"},on:{click:function(t){return e.assignPlayerModal(a)}}},[n("i",{staticClass:"fa fa-edit"})])],1)],1)}))],2),null==e.envPlayers||0==e.envPlayers.length?n("div",[n("b-row",[n("b-col",[e._v(" No Players Found ")])],1)],1):e._e()]),e.envSpec&&"RL_SINGLEPLAYER_ENV"==e.envSpec.envType?n("div",{staticClass:"mt-2"},[n("hl"),n("h4",[e._v("Environment Instances")]),n("b-form-input",{staticClass:"ml-2 pl-5",staticStyle:{width:"100px"},attrs:{type:"number"},model:{value:e.batchSize,callback:function(t){e.batchSize=t},expression:"batchSize"}})],1):e._e()])],1)],1)],1)],1)],1)],1)],1),n("div",{staticClass:"mt-4"}),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-select-envspec",modifiers:{"modal-select-envspec":!0}}],attrs:{size:"sm",variant:"secondary"}},[e._v("Change Environment")])],1):n("div",[n("b-card",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-select-envspec",modifiers:{"modal-select-envspec":!0}}],staticClass:"h-100 card-shadow card-flyer",staticStyle:{width:"100px","background-color":"#ccc",color:"#000"},attrs:{"body-text-variant":""}},[n("b-card-body",{staticClass:"text-center"},[n("div",[n("i",{staticClass:"fa fa-plus"})])])],1)],1)])],1),n("div",{staticClass:"mt-4"}),n("hr"),n("div",{staticClass:"mt-4"}),n("h3",[n("i",{staticClass:"fas fa-robot"}),e._v(" Agents")]),n("div",{staticClass:"mt-4"}),n("b-row",[n("b-col",{staticClass:"d-flex flex-wrap mb-4"},[e._l(e.agents,(function(t,a){return n("span",{key:a,staticClass:"mr-3"},[n("b-card",{staticClass:"h-100 card-shadow card-flyer stretched-link",staticStyle:{width:"320px"},attrs:{"no-body":"","header-bg-variant":"info","header-text-variant":"white",type:"button"},on:{click:function(t){return e.agentConfigModal(a)}},scopedSlots:e._u([{key:"header",fn:function(){return[n("div",{staticClass:"custom-card-header  mb-2"},[e._v(" "+e._s(t.ident)+" ")])]},proxy:!0}],null,!0)},[n("b-container",{staticClass:"mt-2"},[n("b-row",[n("b-col",[n("b-card-img",{staticClass:"svgagent",staticStyle:{"max-height":"100px"},attrs:{src:"/img/agent_cons/"+e.getImageId(t.ident)+".SVG",alt:"Image"}})],1)],1),n("div",{staticClass:"mt-3"}),n("b-row",[n("b-col",[n("div",[n("span",{staticClass:"data_label"},[e._v("Spec Id: ")]),e._v(" "+e._s(t.specId)+" ")]),n("div",{staticClass:"data_label"}),n("div",{staticClass:"data_label"},[e._v(" Players Assigned: "+e._s(e.getPlayersForAgent(a).join(" "))+" ")])])],1)],1)],1)],1)})),n("span",[n("b-card",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-select-agent",modifiers:{"modal-select-agent":!0}}],staticClass:"h-100 card-shadow card-flyer  ",staticStyle:{width:"100px","background-color":"#ccc",color:"#000"},attrs:{"body-text-variant":""}},[n("b-card-body",{staticClass:"text-center align-middle"},[n("i",{staticClass:"fa fa-plus"})])],1)],1)],2)],1),n("div",{staticClass:"mt-4"}),Object.keys(e.agents).length>1?n("div",[n("hr"),n("div",{staticClass:"mt-2 mb-3"},[n("div",{staticClass:"h-5"},[e._v("Multi Agent Session Configuration "),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-config",modifiers:{"modal-config":!0}}],attrs:{size:"sm",variant:"white"}},[n("i",{staticClass:"fa fa-edit"})])],1)])]):e._e(),n("div",{staticClass:"mt-4"}),n("hr"),n("b-row",[n("b-col",[e.errorMessage?n("b-alert",{attrs:{show:"",variant:"danger"}},[e._v(" Submission Failed: "+e._s(e.errorMessage)+" "),n("div",[n("pre",{staticClass:"error"},[e._v(e._s(e.traceback))])])]):e._e(),n("div",{staticClass:"ml-auto"},[e.submitting?n("b-button",{attrs:{variant:"primary",disabled:""}},[n("b-spinner",{attrs:{small:"",type:"grow"}}),e._v("Processing... ")],1):n("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:e.sendData}},[e._v("Submit")]),n("b-button",{staticClass:"ml-2",attrs:{size:"sm",variant:"primary"},on:{click:function(t){return e.showFullConfig()}}},[e._v("View Config Output")])],1)],1)],1)],1)],1),n("div")],1)},s=[],i=(n("a623"),n("4160"),n("d81d"),n("a9e3"),n("b64b"),n("07ac"),n("ac1f"),n("1276"),n("159b"),n("8785")),r=n("bc3a"),o=n.n(r),l=n("4023"),c=n("9530"),d=n.n(c),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"agentnew",size:"xl","hide-header":!0,"hide-footer":!0}},[n("AgentNew",{attrs:{specId:e.selectedSpecId},on:{agentCreated:function(t){return e.agentCreated(t)}}})],1),n("b-modal",{attrs:{id:"agentspecs",size:"xl","hide-header":!0,"hide-footer":!0}},[n("AgentSpecs",{on:{specSelected:function(t){return e.newAgentModal(t)}}})],1),n("b-button-toolbar",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal:agentspecs",arg:"agentspecs"}],attrs:{target:"_blank",variant:"primary",size:"sm"}},[e._v("New Agent Instance")]),n("b-button",{staticClass:"ml-auto",attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.refreshAgents()}}},[e._v("Refresh List ")])],1),n("div",{staticClass:"mt-4"}),e._l(e.agents,(function(t,a){return n("div",{key:a},[n("AgentRowSelect",{attrs:{agent:t},on:{click:function(n){return e.selectAgent(t)}}}),n("hr")],1)}))],2)},g=[],p=(n("bbd0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.agent&&e.agent.ident?n("div",[n("b-row",[n("b-col",{attrs:{cols:"2"}},[n("img",{staticClass:"svgagent",staticStyle:{"max-height":"60px"},attrs:{src:"/img/agent_cons/"+e.getImageId(e.agent.ident)+".SVG",alt:"Image"}})]),n("b-col",[n("b-row",[n("b-col",[n("div",[n("router-link",{attrs:{target:"_blank",to:"/agent/view/"+e.agent.ident}},[e._v(" "+e._s(e.agent.ident))])],1)]),n("b-col",[n("div",[n("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:function(t){return e.select()}}},[e._v("Select")])],1)])],1),n("div",{staticClass:"mt-1"}),n("b-row",[n("b-col",[n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Spec Id: ")]),n("span",[e._v(e._s(e.agent.specId))])]),n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("created: ")]),n("span",[e._v(e._s(e.agent.created))])])]),n("b-col")],1),n("b-row",{staticClass:"mt-2"},[n("b-col",[n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Observation Space ")]),n("pre",[e._v(e._s(JSON.stringify(e.config.observation_space,null,2)))])])]),n("b-col",[n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Action Space ")]),n("pre",[e._v(e._s(JSON.stringify(e.config.action_space,null,2)))])])])],1)],1)],1)],1):e._e()}),v=[],f={props:{agent:Object},data:function(){return{}},mounted:function(){},methods:{getImageId:function(e){var t=parseInt(e.split("-")[1]);return t%19},select:function(){this.$emit("click")}},computed:{lastCheckpoint:function(){return this.agent&&this.agent.lastCheckpoint?JSON.parse(this.agent.lastCheckpoint).id:"NA"},config:function(){return JSON.parse(this.agent.config)},meta:function(){return JSON.parse(this.agent.meta)}},created:function(){},beforeDestroy:function(){}},b=f,m=n("2877"),h=Object(m["a"])(b,p,v,!1,null,"01a7fbd4",null),_=h.exports,y=n("3812"),S=n("c5bd");function k(){var e=Object(i["a"])(["\n  {\n    allAgents {\n      edges {\n        node {\n          id\n          ident\n          displayedName\n          created\n          specId\n\n          config\n          status\n        }\n      }\n    }\n  }\n"]);return k=function(){return e},e}function C(){var e=Object(i["a"])(["\n  query {\n    agentSpecs {\n      id\n      ident\n      created\n      displayedName\n      config\n      params\n    }\n  }\n"]);return C=function(){return e},e}var w=d()(C()),A=d()(k()),I={components:{AgentRowSelect:_,AgentSpecs:y["a"],AgentNew:S["a"]},props:{},apollo:{agentSpecs:w,allAgents:A},data:function(){return{allAgents:[],selectedExistingAgent:null,selectedSpecId:null}},mounted:function(){},methods:{agentCreated:function(e){this.$bvModal.hide("agentnew"),this.refreshAgents()},newAgentModal:function(e){this.selectedSpecId=e,this.$bvModal.hide("agentspecs"),this.$bvModal.show("agentnew")},selectAgent:function(e){this.$emit("click",e.ident)},getImageId:function(e){var t=parseInt(e.split("-")[1]);return t%19},refreshAgents:function(){this.$apollo.queries.allAgents.refetch()}},computed:{agents:function(){return 0==this.allAgents.length?[]:this.allAgents.edges.map((function(e){return e.node}))}},created:function(){},beforeDestroy:function(){}},N=I,E=Object(m["a"])(N,u,g,!1,null,"99388020",null),x=E.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-container",{attrs:{fluid:""}},e._l(e.envSpecs,(function(t,a){return n("div",{key:a},[n("b-row",[n("b-col",[n("div",[n("router-link",{attrs:{to:"/env_spec/view/"+t.ident}},[e._v(" "+e._s(t.displayedName))])],1)]),n("b-col",[n("div",[n("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:function(n){return e.select(t.ident)}}},[e._v("Select")])],1)])],1),n("div",{staticClass:"mt-1"}),n("b-row",[n("b-col",{},[n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Environment: ")]),n("span",[e._v(e._s(t.environment.ident))])]),n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Version: ")]),n("span",[e._v(e._s(t.environment.version))])]),n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Plugin: ")]),n("span",[e._v(e._s(t.environment.pluginId)+": "+e._s(t.environment.pluginVersion))])])]),n("b-col",{},[n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Type: ")]),n("span",[e._v(e._s(t.envType))])]),n("div",[n("span",{staticClass:"data_label mt-1"},[e._v("Description: ")]),n("span",[e._v(e._s(t.description))])])])],1),n("hr")],1)})),0),n("div",{staticClass:"mt-2"})],1)},M=[];function T(){var e=Object(i["a"])(["\n  query {\n    envSpecs {\n      id\n      ident\n      displayedName\n      config\n      meta\n      \n      envType\n      description\n      environment{\n          id\n          ident\n          pluginId\n            version\n            pluginVersion\n      }\n    }\n  }\n"]);return T=function(){return e},e}var P=d()(T()),$={props:{},apollo:{envSpecs:P},data:function(){return{envSpecs:[],selectedExistingAgent:null}},mounted:function(){},methods:{select:function(e){this.$emit("click",e)}},computed:{},created:function(){},beforeDestroy:function(){}},R=$,z=Object(m["a"])(R,O,M,!1,null,"51ab36f6",null),F=z.exports,q=n("321f"),J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[e._v(" Task ID: "),n("router-link",{attrs:{to:"/task/view/"+e.uid}},[e._v(e._s(e.uid))])],1),"RUNNING"==e.task.status?n("div",[e._v(" Loading... ")]):n("div",[e._v(" Status: "+e._s(e.task.status)+" ")]),n("div",[n("LogViewer",{attrs:{nocard:!0,logStreamUrl:e.appConfig.API_URL+"/api/stream/entity_logs/task/"+e.uid}})],1)])},V=[],L=n("1577");function j(){var e=Object(i["a"])(["\n  query GetTask($ident: String!) {\n    task(ident: $ident) {\n      id\n      ident\n      status\n      statusMsg\n      config\n      created\n      summary\n      primarySession{\n          id\n          ident\n      }\n     \n    }\n  }\n"]);return j=function(){return e},e}var G=d()(j()),D={name:"TaskLoad",components:{LogViewer:L["a"]},apollo:{task:{query:G,variables:function(){return{ident:this.uid}},pollInterval:2e3}},data:function(){return{task:{},error:"",appConfig:l["a"],intervalTimer:null}},props:{uid:String,redirectToSession:Boolean},created:function(){var e=this;console.log(this.uid),this.intervalTimer=setInterval((function(){console.log("Checking"),e.$apollo.queries.task.loading||(e.task.status&&"RUNNING"==e.task.status?e.task.primarySession&&e.task.primarySession.ident?e.$router.push({path:"/session/view/"+e.task.primarySession.ident}):(console.log("Refetch"),e.$apollo.queries.task.refetch()):e.task.status&&"RUNNING"!=e.task.status&&"CREATED"!=e.task.status&&e.$router.push({path:"/task/view/"+e.task.ident}))}),1e3)},beforeDestroy:function(){this.intervalTimer&&clearInterval(this.intervalTimer)}},U=D,W=Object(m["a"])(U,J,V,!1,null,null,null),K=W.exports;function B(){var e=Object(i["a"])(["\n  query GetAgent($ident: String!) {\n    agent(ident: $ident) {\n        id\n          ident\n          created\n          specId\n          config\n            spec{\n                id\n                params\n            }\n    }\n  }\n"]);return B=function(){return e},e}function Y(){var e=Object(i["a"])(["\n  query GetTask($ident: String!) {\n    task(ident: $ident) {\n      id\n      ident\n      specId\n      config\n    }\n  }\n"]);return Y=function(){return e},e}function X(){var e=Object(i["a"])(["\n  query GetEnvSpec($ident: String!) {\n    envSpec(ident: $ident) {\n      id\n      ident\n      displayedName\n      config\n      meta\n      envType\n      environment {\n          id\n        ident\n      }\n    }\n  }\n"]);return X=function(){return e},e}function H(){var e=Object(i["a"])(["\n  {\n    wrappers: envWrappers {\n      entry_point\n      kwargs\n    }\n  }\n"]);return H=function(){return e},e}var Q=[{key:"max_episodes",label:"Max Episodes",description:"Max Episodes before Termination",defaultValue:null,type:"number"},{key:"max_steps",label:"Max Steps",description:"Max Steps before Termination",defaultValue:null,type:"number"},{key:"max_steps_in_episode",label:"Max Steps per Episode",description:"Max Steps per Episode",defaultValue:null,type:"number"},{key:"episode_record_freq",label:"Ep Record Freq",description:"Frequency of Episode Recordings",defaultValue:50,type:"number"},{key:"episode_record_preview_interval",label:"Episode Record Preview Interval",description:"Interval for preview generation",defaultValue:1,type:"number",isNumber:!1},{key:"step_log_freq",label:"Step Log Freq",description:"Frequency of Step Logging",defaultValue:30,type:"number"},{key:"episode_log_freq",label:"Episode Log Freq",description:"Frequency of Episode Summary Logging",defaultValue:1,type:"number"},{key:"preview_rendering",label:"Use Preview Rendering",description:"Enable Preview Rendering using environment render function",defaultValue:!0,type:"boolean"},{key:"frame_stream_enabled",label:"Enable Live Frame Stream",description:"Enable Live Frame Stream (preview rendering must also be enabled)",defaultValue:!0,type:"boolean"}],Z=[{key:"max_epochs",label:"Max Epochs",description:"Max Epochs before Termination",defaultValue:null,type:"number"},{key:"max_batches",label:"Max Batches",description:"Max Batches before Termination",defaultValue:null,type:"number"}];function ee(e){var t={};return e.forEach((function(e){t[e.key]=e.defaultValue})),t}var te=d()(H()),ne=d()(X()),ae=d()(Y()),se=d()(B()),ie={name:"AgentTaskNew",components:{AgentSelector:x,EnvSelector:F,TaskLoad:K,ParamEditor:q["a"]},apollo:{wrappers:te,envSpec:{query:ne,skip:!0,variables:function(){return{ident:this.selectedEnvSpecId}}}},data:function(){return{appConfig:l["a"],selectedEnvSpecId:null,envSpec:null,envSpecKwargOverrides:"{}",batchSize:1,agents:{},agentConfigs:{},currentAgentIdx:null,selectedAgent:null,agentWrappers:[],agentRunConfig:{},agentSessionConfig:{},agentSessionConfigFields:[],wrappers:[],currentPlayerId:null,envPlayers:[],envMeta:{},errorMessage:"",traceback:"",submitting:!1,newTaskId:null,rlSessionConfigFields:Q,dataSessionConfigFields:Z,sessionConfig:ee(Q),fullConfig:"{}"}},props:{uid:String,agentUid:String,envSpecId:String},computed:{wrapperOptions:function(){return this.wrappers.map((function(e,t){return{value:t,text:e["entry_point"]}}))},checkSpaceMatch:function(){if(null==this.envSpec||null==this.agent)return"NA";var e=JSON.parse(this.envSpec.meta).observation_space,t=JSON.parse(this.agent.config).observation_space;return JSON.stringify(e)==JSON.stringify(t)?"Compatible":"Incompatible"},selectedAgentParams:function(){return this.selectedAgent&&this.selectedAgent.spec?JSON.parse(this.selectedAgent.spec.params):null}},watch:{wrappers:function(e){this.wrappers=e},envSpec:function(e){this.envSpec=e,this.envSpec&&(this.envMeta=JSON.parse(this.envSpec.meta),this.resetPlayers())}},methods:{showFullConfig:function(){this.fullConfig=JSON.stringify(this.prepData(),null,2),this.$bvModal.show("modal-full-config")},agentConfigModal:function(e){this.currentAgentIdx=e;var t=this.agents[this.currentAgentIdx];console.log(JSON.stringify(t,null,2)),this.selectedAgent=t,this.agentSessionConfigFields=t["session_config_fields"],this.agentWrappers=t["wrappers"],this.agentRunConfig=t["run_config"],this.agentSessionConfig=t["session_config"],this.$bvModal.show("modal-configure-agent")},updateAgentConfig:function(){var e=this.agents[this.currentAgentIdx];e["wrappers"]=this.agentWrappers,e["session_config"]=this.agentSessionConfig,e["run_config"]=this.agentRunConfig,e["config"]=this.selectedAgentConfig,this.$set(this.agents,e.ident,e),this.$bvModal.hide("modal-configure-agent")},selectEnvSpec:function(e){this.$bvModal.hide("modal-select-envspec"),this.selectedEnvSpecId=e,this.$apollo.queries.envSpec.skip=!1,this.$apollo.queries.envSpec.refetch()},selectAgent:function(e){if(console.log("Select Agent"),console.log(JSON.stringify(e)),Object.keys(this.agents).every((function(t){return t!=e.ident}))){this.$set(this.agents,e.ident,e),e["run_config"]=JSON.parse(e.config),console.log(JSON.stringify(e["run_config"],null,2)),e["interface_type"]=e["run_config"]["interfaces"]["run"]["interface_type"];var t="rl"==e["interface_type"]?this.rlSessionConfigFields:this.dataSessionConfigFields;e["session_config"]=ee(t),e["session_config_fields"]=t,e["wrappers"]=[],this.autoAssign(),this.$bvModal.hide("modal-select-agent")}},assignPlayerModal:function(e){console.log(e),this.currentPlayerId=e,this.$bvModal.show("assign-player-modal")},assignPlayerToAgent:function(e,t){this.$set(this.envPlayers[e],"agent",t),this.$bvModal.hide("assign-player-modal")},getPlayersForAgent:function(e){var t=[];return this.envPlayers.forEach((function(n){n.agent==e&&t.push(n.id)})),0==t.length&&t.push("None"),t},resetPlayers:function(){if(this.envSpec&&"possible_players"in this.envMeta){var e=this.envMeta,t=[];e.possible_players.forEach((function(n){var a={id:n,observation_space:e.observation_spaces[n],action_space:e.action_spaces[n]};t.push(a)})),this.envPlayers=t,this.autoAssign()}else this.envPlayers=[]},getImageId:function(e){var t=parseInt(e.split("-")[1]);return t%19},prepData:function(){var e=this;try{var t=[];Object.values(this.agents).forEach((function(n){var a={};a["ident"]=n.ident,a["run_config"]=n.run_config,a["session_config"]=n.session_config,a["session_config"]["wrappers"]=n.wrappers.map((function(t){return e.wrappers[t]})),n.session_config_fields.forEach((function(e){"number"==e.type&&(a["session_config"][e.key]=Number(a["session_config"][e.key]))})),t.push(a)})),this.rlSessionConfigFields.forEach((function(t){"number"==t.type&&(e.sessionConfig[t.key]=Number(e.sessionConfig[t.key]))}));var n={};this.envPlayers.forEach((function(e){n[e.id]=e.agent}));var a={agents:t,env_spec_id:this.envSpec.ident,env_kwargs:JSON.parse(this.envSpecKwargOverrides),session_config:this.sessionConfig,player_assignments:n,batch_size:parseInt(this.batchSize)};return console.log("SENDING "+JSON.stringify(a)),a}catch(s){return{error:s}}},sendData:function(){var e=this;this.submitting=!0,console.log("sending data");try{var t=this.prepData();o.a.post("".concat(l["a"].API_URL,"/api/submit_agent_task"),t).then((function(t){var n=t.data["item"];"uid"in n?(e.newTaskId=n.uid,e.$bvModal.show("modal-launch-task")):(console.log("ERROR in response "+JSON.stringify(n)),e.errorMessage=JSON.stringify(n["error"])),e.traceback=n["traceback"],e.submitting=!1})).catch((function(e){this.errorMessage=e,this.submitting=!1}))}catch(n){console.log("ERROR "+n),this.error=n,this.submitting=!1}},loadTaskInfo:function(){null!=this.uid&&console.log("TODO")},loadAgent:function(e){var t=this;console.log("Preloading agent "+e),this.$apollo.query({query:se,variables:{ident:e}}).then((function(e){console.log(e),t.selectAgent(e.data.agent)})).catch((function(e){t.error="ERROR GETTING AGENT  "+e,console.log(t.error)}))},duplicateTask:function(e){var t=this;console.log("Preloading task "+e),this.$apollo.query({query:ae,variables:{ident:e}}).then((function(e){var n=JSON.parse(e.data.task.config);console.log(JSON.stringify(n,null,2)),n.agents?n.agents.forEach((function(e){return t.loadAgent(e.ident)})):t.loadAgent(n.agent_id),t.selectEnvSpec(n.env_spec_id),t.sessionConfig=n["session_config"],t.envSpecKwargOverrides=JSON.stringify(n["env_kwargs"])})).catch((function(n){t.error="ERROR GETTING TASK with id "+e,console.log(t.error)}))},removeAgent:function(){this.$delete(this.agents,this.currentAgentIdx),this.$bvModal.hide("modal-configure-agent"),this.autoAssign()},autoAssign:function(){var e=this;if(0!=this.envPlayers.length&&0!=this.agents.length){var t=Object.keys(this.agents).map((function(e,t){return e}));this.envPlayers.forEach((function(n,a){console.log("p "+a+" agent: "+t),e.$set(e.envPlayers[a],"agent",t[a%t.length])}))}}},created:function(){this.submitting=!1,console.log("Env Spec Id "+this.envSpecId),console.log("Agent UID: "+this.agentUid),console.log("Task UID: "+this.uid),this.uid&&this.duplicateTask(this.uid),this.envSpecId&&this.selectEnvSpec(this.envSpecId),this.agentUid&&this.loadAgent(this.agentUid)}},re=ie,oe=(n("bc51"),Object(m["a"])(re,a,s,!1,null,"4245a1e8",null));t["default"]=oe.exports},"8d94":function(e,t,n){},a623:function(e,t,n){"use strict";var a=n("23e7"),s=n("b727").every,i=n("a640"),r=n("ae40"),o=i("every"),l=r("every");a({target:"Array",proto:!0,forced:!o||!l},{every:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},a9e3:function(e,t,n){"use strict";var a=n("83ab"),s=n("da84"),i=n("94ca"),r=n("6eeb"),o=n("5135"),l=n("c6b6"),c=n("7156"),d=n("c04e"),u=n("d039"),g=n("7c73"),p=n("241c").f,v=n("06cf").f,f=n("9bf2").f,b=n("58a8").trim,m="Number",h=s[m],_=h.prototype,y=l(g(_))==m,S=function(e){var t,n,a,s,i,r,o,l,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=b(c),t=c.charCodeAt(0),43===t||45===t){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+c}for(i=c.slice(2),r=i.length,o=0;o<r;o++)if(l=i.charCodeAt(o),l<48||l>s)return NaN;return parseInt(i,a)}return+c};if(i(m,!h(" 0o1")||!h("0b1")||h("+0x1"))){for(var k,C=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof C&&(y?u((function(){_.valueOf.call(n)})):l(n)!=m)?c(new h(S(t)),n,C):S(t)},w=a?p(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;w.length>A;A++)o(h,k=w[A])&&!o(C,k)&&f(C,k,v(h,k));C.prototype=_,_.constructor=C,r(s,m,C)}},bc51:function(e,t,n){"use strict";var a=n("8d94"),s=n.n(a);s.a}}]);
//# sourceMappingURL=chunk-799e1728.13408d63.js.map