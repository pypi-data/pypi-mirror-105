(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20f914"],{b3d1:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("h1",[t._v("Task Details")]),a("b-modal",{attrs:{id:"modal-config",title:"View config"}},[a("div",[a("pre",[t._v(t._s(t.taskConfig))])])]),a("b-modal",{attrs:{id:"modal-summary",title:"View Summary"}},[t.task&&t.task.summary?a("pre",[t._v("        "+t._s(t.task.summary)+"\n        ")]):t._e()]),a("b-modal",{attrs:{id:"modal-modify-source",title:"TODO"}},[t._v(" TODO ")]),a("b-button-toolbar",{staticClass:"mr-1",attrs:{size:"sm"}},[a("b-button",{attrs:{size:"sm",to:"/data_browser/?path=task/"+t.uid}},[t._v("Browse Data")]),a("b-button",{staticClass:"ml-1",attrs:{size:"sm",to:"/task/new/agenttask/"+t.task.ident}},[t._v("Duplicate")]),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-config",modifiers:{"modal-config":!0}}],staticClass:"ml-1",attrs:{size:"sm"}},[t._v("View Config")]),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-summary",modifiers:{"modal-summary":!0}}],staticClass:"ml-1",attrs:{size:"sm"}},[t._v("View Summary")]),a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.logs",modifiers:{logs:!0}}],staticClass:"ml-1",attrs:{size:"sm",variant:"info"}},[t._v("Log")]),t.task.status&&"RUNNING"==t.task.status?a("b-button",{staticClass:"ml-1",attrs:{size:"sm",variant:"danger"},on:{click:function(s){return t.taskControl("STOP")}}},[t._v("Abort")]):t._e(),!t.task.status||"ABORTED"!=t.task.status&&"TERMINATED"!=t.task.status?t._e():a("b-button",{staticClass:"ml-1",attrs:{size:"sm",variant:"success"},on:{click:function(s){return t.taskControl("RUN")}}},[t._v("Run")]),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-modify-source",modifiers:{"modal-modify-source":!0}}],staticClass:"ml-1",attrs:{size:"sm"}},[t._v("Run in debug mode (TODO)")]),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-modify-source",modifiers:{"modal-modify-source":!0}}],staticClass:"ml-1",attrs:{size:"sm"}},[t._v("Modify Source Code (TODO)")])],1),a("div",{staticClass:"mt-4"}),a("b-collapse",{staticClass:"mt-2",attrs:{id:"logs"}},[a("LogViewer",{attrs:{logStreamUrl:t.appConfig.API_URL+"/api/stream/entity_logs/task/"+t.uid}})],1),a("b-container",{attrs:{fluid:""}},[a("b-row",[a("b-col",[a("b-card",{staticClass:"h-100"},[a("b-card-text",{staticClass:"pl-2"},[a("div",{staticClass:"pt-2"},[a("div",{staticClass:"data_label"},[t._v("UID")]),a("span",[t._v(t._s(t.uid))])]),a("div",{staticClass:"pt-2"},[a("div",{staticClass:"data_label"},[t._v("Creation Time")]),a("span",[t._v(t._s(t.task.created))])]),a("div",{staticClass:"pt-2"},[a("div",{staticClass:"data_label"},[t._v("Status")]),t.task.status?a("div",[t._v(" "+t._s(t.task.status)+" "),t.task.status&&t.task.statusMsg?a("span",{},[t._v("("+t._s(t.task.statusMsg)+")")]):t._e()]):t._e()])])],1)],1),a("b-col",[a("b-card",{staticClass:"h-100"},[a("b-card-text",[a("div",{staticClass:"pt-2"},[a("div",{staticClass:"data_label"},[t._v("Parent Task")]),t.task.parentTask?a("div",[a("router-link",{attrs:{to:"/task/view/"+t.task.parentTaskId}},[t._v(t._s(t.task.parentTaskId))]),t._v(" ("+t._s(t.task.parentTask.specId)+") ")],1):a("div",[t._v("No Parent")])]),a("div",{staticClass:"pt-2"},[a("div",{staticClass:"data_label"},[t._v("Primary Session")]),t.task.primarySessionId?a("div",[a("router-link",{attrs:{to:"/session/view/"+t.task.primarySessionId}},[t._v(t._s(t.task.primarySessionId))])],1):a("div",[t._v("No Primary Session")])])])],1)],1)],1),a("div",{staticClass:"mt-4"}),a("b-row",[a("b-col",[t.sessionData.length>0?a("div",[a("b-card",{staticClass:"mt-3",attrs:{title:"Sessions"}},[a("b-table",{attrs:{striped:"",hover:"","table-busy":"",items:t.sessionData,fields:t.fields,dark:!1,small:!1},scopedSlots:t._u([{key:"cell(link)",fn:function(s){return[a("router-link",{attrs:{to:"/session/view/"+s.item.ident}},[t._v(t._s(s.item.ident))])]}}],null,!1,3670971571)})],1)],1):t._e()])],1),a("div",{staticClass:"mt-4"}),a("b-row",[a("b-col",[t.subtaskData.length>0?a("b-card",{attrs:{title:"Sub Tasks"}},[a("b-table",{attrs:{hover:"","table-busy":"",items:t.subtaskData,fields:t.subtaskfields,dark:!1,small:!1},scopedSlots:t._u([{key:"cell(link)",fn:function(s){return[a("router-link",{attrs:{to:"/task/view/"+s.item.ident}},[t._v(t._s(s.item.ident))])]}}],null,!1,2816067904)})],1):t._e()],1)],1)],1),a("div",{staticClass:"mt-4"})],1)},i=[],n=(a("99af"),a("b85c")),r=a("8785"),o=a("bc3a"),l=a.n(o),d=a("4023"),c=a("bbd0"),u=a("9530"),m=a.n(u),k=a("1577");function b(){var t=Object(r["a"])(["\n  query GetTask($ident: String!) {\n    task(ident: $ident) {\n      id\n      ident\n      status\n      statusMsg\n\n      config\n      created\n      summary\n\n      primarySessionId\n      parentTaskId\n      parentTask {\n        specId\n      }\n      sessions {\n        pageInfo {\n          startCursor\n          endCursor\n        }\n        edges {\n          node {\n              id\n            ident\n            envSpecId\n            agentId\n            created\n            status\n            summary\n          }\n        }\n      }\n      childTasks {\n        pageInfo {\n          startCursor\n          endCursor\n        }\n        edges {\n          node {\n              id\n            ident\n            created\n            specId\n            status\n            summary\n          }\n        }\n      }\n    }\n  }\n"]);return b=function(){return t},t}var v=[{key:"link",label:"Session",sortable:!0},{key:"envSpecId",label:"Environment"},{key:"created",label:"Created",sortable:!0},{key:"status",label:"State"}],f=[{key:"link",label:"Task",sortable:!0},{key:"specId",label:"Spec Id",sortable:!0},{key:"created",label:"Created",sortable:!0},{key:"status",label:"State"}],p=m()(b()),g={name:"Task",components:{LogViewer:k["a"]},apollo:{task:{query:p,variables:function(){return{ident:this.uid}},pollInterval:2e3}},data:function(){return{appConfig:d["a"],fields:v,subtaskfields:f,task:{},taskLogData:[],error:"",intervalTimer:null}},props:{uid:String},computed:{taskConfig:function(){return this.task.config?JSON.parse(this.task.config):""},taskSummary:function(){return this.task&&this.task.summary?JSON.stringify(this.task.summary):"{}"},sessionData:function(){var t=[];if(null==this.task.sessions||0==this.task.sessions.edges.length)return[];var s,a=Object(n["a"])(this.task.sessions.edges);try{for(a.s();!(s=a.n()).done;){var e=s.value;t.push(e.node)}}catch(i){a.e(i)}finally{a.f()}return t},subtaskData:function(){var t=[];if(null==this.task.childTasks||0==this.task.childTasks.edges.length)return[];var s,a=Object(n["a"])(this.task.childTasks.edges);try{for(a.s();!(s=a.n()).done;){var e=s.value;t.push(e.node)}}catch(i){a.e(i)}finally{a.f()}return t}},methods:{timepretty:c["f"],taskControl:function(t){var s=this;"STOP"==t?l.a.get("".concat(d["a"].API_URL,"/api/admin/task/stop/").concat(this.uid)).then((function(t){s.message=t.data["message"]})).catch((function(t){s.error=t,s.message=s.error})):"RUN"==t&&(console.log("RUN"),l.a.get("".concat(d["a"].API_URL,"/api/admin/task/run/").concat(this.uid)).then((function(t){s.message=t.data["message"],console.log(s.message)})).catch((function(t){s.error=t,s.message=s.error,console.log(s.error)})))}},created:function(){var t=this;console.log(this.uid),this.intervalTimer=setInterval((function(){t.$apollo.queries.task.loading||(!t.task.status||"RUNNING"!=t.task.status&&"CREATED"!=t.task.status?clearInterval(t.intervalTimer):t.$apollo.queries.task.refetch())}),1e3)},beforeDestroy:function(){this.intervalTimer&&clearInterval(this.intervalTimer)}},_=g,h=a("2877"),y=Object(h["a"])(_,e,i,!1,null,null,null);s["default"]=y.exports}}]);
//# sourceMappingURL=chunk-2d20f914.103a6736.js.map