(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[4533],{24533:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var l=s(56271),n=s.n(l),a=s(53521),o=s(7560),c=s(39030),r=s(98537),i=s.n(r),u=s(2689),p=s.n(u),d=s(95479),m=s(13423);const b=e=>{const t=[];return e.forEach((e=>{const s=e.name;t.includes(s)||(e.showlegend=!0,t.push(s))})),e};function h({cube:e,data:t,metaData:s,widgetState:{colors:l,isTextVisible:n,mapping:o,opacity:c=1}}){if(!e||!t||!s)return[];const r={},u={},m={mapping:{},numberOfUsedAutomaticColors:0},{attributesRedirection:h}=s,y=o.size.length>0;let g=0;const x=o.horizontalSubplots.length+o.verticalSubplots.length>0;(0,d.IG)(t,s.hierarchyIndicesInCellSet,(({cell:e,cellIndex:t,columnIndex:p,tuple:d,rowIndex:b})=>{const y=(0,a._F)(d,{levelIndices:s.levelIndicesPerField,mapping:o,attributesRedirection:h}),x=[...y.color,...y.horizontalSubplots,...y.verticalSubplots],I=y.splitBy,f=(0,a.Lj)(x),v=(0,a.Lj)(I),w=e.value,k=(({membersPerAttribute:e,pointKey:t,traceKey:o})=>(u[o]||(u[o]=function({traceKey:e,membersPerAttribute:t}){const o=(0,a.Ym)(t.color,0),r=Object.values(u).some((e=>e.name===o)),i=(0,a.he)({accumulator:m,colorway:s.colorway,colors:l,traceName:o});return{_key:e,hoverinfo:"none",legendgroup:o,mode:n?"text+markers":"markers",name:o,cellsIndices:[],showlegend:!r,text:[],textposition:"top center",type:"scatter",marker:{size:[],color:i},x:[],y:[],opacity:c}}({traceKey:o,membersPerAttribute:e})),i()(r,{[o]:{[t]:{}}}),r[o][t]))({membersPerAttribute:y,traceKey:f,pointKey:v});if(k.cellsIndices||(k.cellsIndices=[]),k.cellsIndices.push({rowIndex:b,columnIndex:p,cellIndex:t}),y.xValues.length>0)k.x=w;else if(y.yValues.length>0)k.y=w;else if(y.size.length>0){const e=Math.abs(w);k.size=e,e>g&&(g=e)}y.splitBy.length>0&&(k.text=(0,a.KT)(y.splitBy))})),Object.entries(u).forEach((([e,t])=>{const s=r[e];y||(t.marker.size=15),Object.values(s).forEach((e=>{const{cellsIndices:s,x:l,y:n,size:a,text:o}=e;t.cellsIndices.push(s),t.x.push(l),t.y.push(n),t.text.push(o),y&&t.marker.size.push(100*a/g)}))}));const I=Object.values(u);if(I.forEach((e=>{var t;e.axisIndices=p()(null===(t=e.x)||void 0===t?void 0:t.length)})),x){const e=s.subplots,t=(0,a.$)({traces:I,subplotsMetaData:e});return(0,a.Mr)(t,e),b(t),t}return b(I),I}const y=(0,a.i)((0,a.H9)((0,l.memo)((e=>{const{cube:t,data:s,metaData:r,widgetState:i,onLoaded:u}=e,p=(0,l.useMemo)((()=>(0,c.TS)(null==i?void 0:i.mapping)),[null==i?void 0:i.mapping]);(0,a.ge)({isEmpty:p,onLoaded:u});const d=(0,l.useMemo)((()=>h({cube:t,data:s,metaData:r,widgetState:i})),[t,s,r,i]),b=(0,l.useMemo)((()=>(e=>e?(0,m.IM)(a.bR,(0,a.S5)(e.subplots),(0,a.lH)(e.subplots)):{})(r)),[r]);return t&&s&&r&&!p?n().createElement(a.XN,(0,o.Z)({},e,{traces:d,layout:b,cube:t,data:s,metaData:r})):n().createElement(a.MQ,null)}))))}}]);